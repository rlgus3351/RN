<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>

<body>
    <table id="mytable">
        <thead>
            <tr>
                <th>상품 명</th>
                <th>가격</th>
                <th>재고</th>
                <th>등록일</th>
                <th>판매자 전화번호</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>갤럭시 S </td>
                <td>90만원</td>
                <td>1</td>
                <td>2012.01.01</td>
                <td>010-1234-7894</td>
            </tr>
            <tr>
                <td>아이폰 12</td>
                <td>990$</td>
                <td>010</td>
                <td>2020.01.01</td>
                <td>01012347894</td>
            </tr>
            <tr>
                <td>辛라면</td>
                <td>650원</td>
                <td>96</td>
                <td>2020.01.01</td>
                <td>042-128-1434</td>
            </tr>
        </tbody>
    </table>
    <button onclick="exportTableToExcel()">엑셀 파일 다운로드</button>
    <script>
        function exportTableToExcel() {
            // 테이블 요소 가져오기
            var table = document.getElementById("mytable");
            var workbook = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
            const currentDate = new Date();

            // 각 구성 요소를 가져오기
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth() + 1;
            const day = currentDate.getDate();
            const hours = currentDate.getHours();
            const minutes = currentDate.getMinutes();
            const seconds = currentDate.getSeconds();

            // 날짜와 시간을 문자열로 포맷팅
            const formattedDate = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')} ${String(hours).padStart(2, '0')}${String(minutes).padStart(2, '0')}${String(seconds).padStart(2, '0')}`;


            // 엑셀 파일로 저장
            XLSX.writeFile(workbook, formattedDate + '.csv');
        }
    </script>

</body>

</html>